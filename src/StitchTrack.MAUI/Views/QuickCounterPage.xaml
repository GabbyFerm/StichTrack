<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="StitchTrack.MAUI.Views.QuickCounterPage"
             BackgroundColor="{AppThemeBinding Light={StaticResource LightPageBackground}, Dark={StaticResource DarkPageBackground}}"
             Shell.NavBarIsVisible="False">

  <!-- 
  QUICK COUNTER PAGE - Minimalist Design
  - Flat layout (no golden header, no card shadows)
  - Session timer with Play/Pause
  - Large counter display
  - Decrease/Increase buttons (gray/golden)
  - Undo/Reset text buttons
  - Save to project outline button
  -->

  <Grid RowDefinitions="Auto,*,Auto"
        RowSpacing="0">

    <!-- ============================================ -->
    <!-- TOP BAR: Logo + Sync Icon                    -->
    <!-- ============================================ -->
    <Grid Grid.Row="0"
          BackgroundColor="{StaticResource AppBackground}"
          Padding="20,15"
          ColumnDefinitions="*,Auto"
          ColumnSpacing="15">

      <!-- Logo -->
      <Image Grid.Column="0"
             Source="logo_white.svg"
             HeightRequest="30"
             HorizontalOptions="Start"
             Aspect="AspectFit">
        <Image.Behaviors>
          <toolkit:IconTintColorBehavior TintColor="White" />
        </Image.Behaviors>
      </Image>

      <!-- Sync Icon (Optional) -->
      <Image Grid.Column="1"
             Source="refresh.svg"
             HeightRequest="24"
             WidthRequest="24"
             HorizontalOptions="End"
             VerticalOptions="Center">
        <Image.Behaviors>
          <toolkit:IconTintColorBehavior TintColor="White" />
        </Image.Behaviors>
        <Image.GestureRecognizers>
          <TapGestureRecognizer Tapped="OnSyncTapped" />
        </Image.GestureRecognizers>
      </Image>

    </Grid>

    <!-- ============================================ -->
    <!-- MAIN CONTENT                                 -->
    <!-- ============================================ -->
    <ScrollView Grid.Row="1">
      <VerticalStackLayout Spacing="20" Padding="20,20,20,20">

        <!-- Page Title -->
        <Label Text="QUICK ROW COUNTER"
               Style="{StaticResource PageTitleLabel}" />

        <!-- Session Timer & Play/Pause -->
        <Grid ColumnDefinitions="*,Auto"
              ColumnSpacing="10"
              Margin="0,5,0,10">

          <!-- Session Timer -->
          <HorizontalStackLayout Grid.Column="0"
                                Spacing="8"
                                VerticalOptions="Center">
            <Image Source="clock.svg"
                   HeightRequest="18"
                   WidthRequest="18">
              <Image.Behaviors>
                <toolkit:IconTintColorBehavior TintColor="{AppThemeBinding Light={StaticResource LightTextSecondary}, Dark={StaticResource DarkTextSecondary}}" />
              </Image.Behaviors>
            </Image>
            <Label Text="SESSION: "
                   FontFamily="MontserratBold"
                   FontSize="12"
                   TextColor="{StaticResource TextSecondary}"
                   VerticalOptions="Center" />
            <Label Text="0h 0m"
                   x:Name="SessionTimerLabel"
                   FontFamily="MontserratSemiBold"
                   FontSize="12"
                   TextColor="{StaticResource TextSecondary}"
                   VerticalOptions="Center" />
          </HorizontalStackLayout>

          <!-- Play/Pause Button -->
          <Button Grid.Column="1"
                  x:Name="SessionButton"
                  Text="â–¶ PLAY"
                  Style="{StaticResource SmallButton}"
                  Clicked="OnSessionButtonClicked" />

        </Grid>

        <!-- Counter Display -->
        <Frame Style="{StaticResource CounterCard}">
          <VerticalStackLayout Spacing="10">

            <Label Text="Current Row"
                   Style="{StaticResource SecondaryLabel}"
                   HorizontalOptions="Center" />

            <Label Text="{Binding CurrentCount}"
                   Style="{StaticResource CounterLabel}"
                   Margin="0,10" />

          </VerticalStackLayout>
        </Frame>

        <!-- Increase / Decrease Buttons -->
        <Grid ColumnDefinitions="*,*"
              ColumnSpacing="15"
              Margin="0,10,0,0">

          <!-- Decrease Button -->
          <Button Grid.Column="0"
                  Text="- DECREASE"
                  Style="{StaticResource SecondaryButton}"
                  Command="{Binding DecrementCommand}" />

          <!-- Increase Button -->
          <Button Grid.Column="1"
                  Text="+ INCREASE"
                  Style="{StaticResource PrimaryButton}"
                  Command="{Binding IncrementCommand}" />

        </Grid>

        <!-- Undo & Reset -->
        <Grid ColumnDefinitions="*,*"
              ColumnSpacing="15"
              Margin="0,5,0,0">

          <Button Grid.Column="0"
                  Text="â†© Undo"
                  Style="{StaticResource TextButton}"
                  HorizontalOptions="Center" />

          <Button Grid.Column="1"
                  Text="â†» Reset"
                  Style="{StaticResource TextButton}"
                  Command="{Binding ResetCommand}"
                  HorizontalOptions="Center" />

        </Grid>

        <!-- Tip -->
        <HorizontalStackLayout Spacing="8"
                              HorizontalOptions="Center"
                              Margin="0,15,0,0">
          <Label Text="ðŸ’¡"
                 FontSize="16"
                 VerticalOptions="Center" />
          <Label Style="{StaticResource CaptionLabel}"
                 LineBreakMode="WordWrap"
                 MaximumWidthRequest="280"
                 VerticalOptions="Center">
            <Label.FormattedText>
              <FormattedString>
                <Span Text="Tip: " FontAttributes="Bold" />
                <Span Text="Tap 'Save to Project' to keep this counter" />
              </FormattedString>
            </Label.FormattedText>
          </Label>
        </HorizontalStackLayout>

        <!-- Save to Project Button -->
        <Button Text="ðŸ’¾ Save to project"
                Style="{StaticResource OutlineButton}"
                Command="{Binding SaveToProjectCommand}"
                Margin="0,10,0,20" />

      </VerticalStackLayout>
    </ScrollView>

    <!-- ============================================ -->
    <!-- BOTTOM NAVIGATION (Managed by AppShell)      -->
    <!-- ============================================ -->
    <!-- TabBar will appear here automatically -->

  </Grid>

</ContentPage>
